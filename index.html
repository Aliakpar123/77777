<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Merci Wish List</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            overflow-x: hidden;
        }
        * { box-sizing: border-box; }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        @keyframes slideUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fadeIn { animation: fadeIn 0.3s ease-out; }
        .animate-slideUp { animation: slideUp 0.4s ease-out; }
        .hidden { display: none; }
    </style>
</head>
<body>
    <div id="app"></div>

    <script>
        // Telegram Web App
        if (window.Telegram?.WebApp) {
            window.Telegram.WebApp.ready();
            window.Telegram.WebApp.expand();
        }

        const BRANDS = [
            { name: '–ó–æ–ª–æ—Ç–æ–µ –Ø–±–ª–æ–∫–æ', logo: 'https://logo-teka.com/wp-content/uploads/2025/07/zolotoe-yabloko-sign-logo.svg' },
            { name: 'Tiffany & Co.', domain: 'tiffany.com' },
            { name: 'Cartier', domain: 'cartier.com' },
            { name: '12 STOREEZ', domain: '12storeez.com' },
            { name: 'Zara', domain: 'zara.com' },
            { name: 'Mango', domain: 'mango.com' },
            { name: 'H&M', domain: 'hm.com' },
            { name: 'Massimo Dutti', domain: 'massimodutti.com' },
            { name: 'Bershka', domain: 'bershka.com' },
            { name: 'LOVE REPUBLIC', domain: 'loverepublic.ru' },
            { name: 'Zarina', domain: 'zarina.ru' },
            { name: 'Wildberries', domain: 'wildberries.ru' },
            { name: 'Ozon', domain: 'ozon.ru' },
            { name: 'Lamoda', domain: 'lamoda.ru' },
            { name: 'Calzedonia', domain: 'calzedonia.com' }
        ];

        let currentView = 'home';
        let wishes = [];
        let showAddForm = false;
        let editingId = null;
        let formTitle = '';
        let formImage = null;

        // Load wishes
        function loadWishes() {
            const saved = localStorage.getItem('merci_wishes');
            if (saved) wishes = JSON.parse(saved);
        }

        function saveWishes() {
            localStorage.setItem('merci_wishes', JSON.stringify(wishes));
        }

        function render() {
            const app = document.getElementById('app');
            
            if (currentView === 'home') {
                app.innerHTML = `
                    <div class="min-h-screen bg-gradient-to-br from-pink-50 via-purple-50 to-blue-50 pb-24">
                        <div class="px-6 pt-8 pb-6">
                            <div class="flex items-center gap-3 mb-6">
                                <div class="bg-gradient-to-br from-pink-400 to-purple-500 p-3 rounded-2xl shadow-lg">
                                    <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v13m0-13V6a2 2 0 112 2h-2zm0 0V5.5A2.5 2.5 0 109.5 8H12zm-7 4h14M5 12a2 2 0 110-4h14a2 2 0 110 4M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"></path>
                                    </svg>
                                </div>
                                <div>
                                    <h1 class="text-4xl font-bold bg-gradient-to-r from-pink-500 to-purple-600 bg-clip-text text-transparent">Merci</h1>
                                    <p class="text-sm text-gray-500">Wish List</p>
                                </div>
                            </div>

                            <button onclick="goToMyList()" class="w-full bg-gradient-to-r from-pink-400 to-purple-500 rounded-3xl p-6 mb-6 shadow-xl hover:shadow-2xl transition-all transform hover:scale-[1.02]">
                                <div class="flex items-center justify-between">
                                    <div class="text-left">
                                        <div class="flex items-center gap-3 mb-2">
                                            <svg class="w-6 h-6 text-white fill-white" viewBox="0 0 24 24">
                                                <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
                                            </svg>
                                            <h3 class="text-xl font-bold text-white">–ú–æ–π Wish List</h3>
                                        </div>
                                        <p class="text-pink-100 text-sm">${wishes.length > 0 ? wishes.length + ' –∂–µ–ª–∞–Ω–∏–π' : '–°–æ–∑–¥–∞–π—Ç–µ —Å–≤–æ–π –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫'}</p>
                                    </div>
                                    <div class="text-2xl text-white">‚Üí</div>
                                </div>
                            </button>
                        </div>

                        <div class="px-6">
                            <h2 class="text-2xl font-bold mb-4 text-gray-700">–ò–¥–µ–∏ –ø–æ–¥–∞—Ä–∫–æ–≤</h2>
                            <div class="overflow-x-auto -mx-6 px-6">
                                <div class="flex gap-4 pb-4">
                                    ${BRANDS.map((brand, i) => `
                                        <button onclick="showBrandModal('${brand.name}')" class="flex-shrink-0 w-32 transform hover:scale-105 transition-all">
                                            <div class="bg-white rounded-3xl aspect-square flex items-center justify-center mb-2 p-4 shadow-lg hover:shadow-xl transition-all">
                                                <img src="${brand.logo || 'https://logo.clearbit.com/' + brand.domain}" alt="${brand.name}" class="w-full h-full object-contain" onerror="this.style.display='none'">
                                            </div>
                                            <div class="text-sm font-semibold text-center text-gray-700">${brand.name}</div>
                                        </button>
                                    `).join('')}
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            } else if (currentView === 'mylist') {
                app.innerHTML = `
                    <div class="min-h-screen bg-gradient-to-br from-pink-50 via-purple-50 to-blue-50 pb-24 px-6">
                        <button onclick="goHome()" class="text-pink-500 font-medium mb-4 mt-8">‚Üê –ù–∞–∑–∞–¥</button>
                        <h2 class="text-2xl font-bold mb-6 text-gray-700">–ú–æ–π Wish List</h2>

                        ${!showAddForm ? `
                            <button onclick="toggleAddForm()" class="w-full bg-white rounded-3xl p-6 shadow-lg border-2 border-pink-200 hover:border-pink-300 transition-all flex items-center justify-center gap-2 text-pink-600 font-semibold">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
                                </svg>
                                –î–æ–±–∞–≤–∏—Ç—å –∂–µ–ª–∞–Ω–∏–µ
                            </button>
                        ` : `
                            <div class="bg-white rounded-3xl p-6 shadow-lg mb-6">
                                <div class="flex justify-between items-center mb-4">
                                    <h3 class="text-xl font-bold text-gray-800">${editingId ? '–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å' : '–ù–æ–≤–æ–µ –∂–µ–ª–∞–Ω–∏–µ'}</h3>
                                    <button onclick="toggleAddForm()" class="text-gray-400 hover:text-gray-600">‚úï</button>
                                </div>
                                <input type="text" id="wishTitle" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ *" value="${formTitle}" class="w-full p-3 border-2 border-gray-200 rounded-2xl mb-4 focus:border-pink-400 focus:outline-none">
                                <div class="mb-4">
                                    <label class="block text-sm font-medium text-gray-700 mb-2">–§–æ—Ç–æ</label>
                                    <input type="file" id="wishImage" accept="image/*" class="w-full p-3 border-2 border-gray-200 rounded-2xl">
                                </div>
                                <button onclick="saveWish()" class="w-full bg-gradient-to-r from-pink-400 to-purple-500 text-white py-3 rounded-2xl font-semibold hover:shadow-lg transition-all">
                                    ${editingId ? '–°–æ—Ö—Ä–∞–Ω–∏—Ç—å' : '–î–æ–±–∞–≤–∏—Ç—å'}
                                </button>
                            </div>
                        `}

                        ${wishes.length === 0 && !showAddForm ? `
                            <div class="bg-white rounded-3xl p-8 text-center shadow-lg mt-6">
                                <div class="bg-gradient-to-br from-pink-100 to-purple-100 w-24 h-24 rounded-full mx-auto mb-4 flex items-center justify-center">
                                    <svg class="w-12 h-12 text-pink-500" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
                                    </svg>
                                </div>
                                <p class="text-gray-600 font-medium">–ù–∞—á–Ω–∏—Ç–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å–≤–æ–π —Å–ø–∏—Å–æ–∫ –∂–µ–ª–∞–Ω–∏–π!</p>
                            </div>
                        ` : `
                            <div class="space-y-4 mt-6">
                                ${wishes.map(wish => `
                                    <div class="bg-white rounded-3xl p-5 shadow-lg">
                                        <div class="flex gap-4">
                                            ${wish.image ? `<img src="${wish.image}" alt="${wish.title}" class="w-24 h-24 object-cover rounded-2xl flex-shrink-0">` : ''}
                                            <div class="flex-1">
                                                <h3 class="font-bold text-lg text-gray-800 mb-3">${wish.title}</h3>
                                                <div class="flex gap-2">
                                                    <button onclick="editWish(${wish.id})" class="p-2 text-blue-500 hover:bg-blue-50 rounded-xl transition-colors">‚úé</button>
                                                    <button onclick="deleteWish(${wish.id})" class="p-2 text-red-500 hover:bg-red-50 rounded-xl transition-colors">üóë</button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        `}
                    </div>
                `;

                if (showAddForm) {
                    document.getElementById('wishImage').addEventListener('change', handleImageUpload);
                }
            }
        }

        function goHome() {
            currentView = 'home';
            render();
        }

        function goToMyList() {
            currentView = 'mylist';
            render();
        }

        function toggleAddForm() {
            showAddForm = !showAddForm;
            if (!showAddForm) {
                editingId = null;
                formTitle = '';
                formImage = null;
            }
            render();
        }

        function handleImageUpload(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = (e) => {
                    formImage = e.target.result;
                };
                reader.readAsDataURL(file);
            }
        }

        function saveWish() {
            const title = document.getElementById('wishTitle').value.trim();
            if (!title) return;

            if (editingId) {
                wishes = wishes.map(w => w.id === editingId ? { ...w, title, image: formImage || w.image } : w);
            } else {
                wishes.unshift({ id: Date.now(), title, image: formImage, createdAt: new Date().toISOString() });
            }
            
            saveWishes();
            editingId = null;
            formTitle = '';
            formImage = null;
            showAddForm = false;
            render();
        }

        function editWish(id) {
            const wish = wishes.find(w => w.id === id);
            if (wish) {
                editingId = id;
                formTitle = wish.title;
                formImage = wish.image;
                showAddForm = true;
                render();
            }
        }

        function deleteWish(id) {
            wishes = wishes.filter(w => w.id !== id);
            saveWishes();
            render();
        }

        function showBrandModal(brandName) {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm animate-fadeIn';
            modal.innerHTML = `
                <div class="bg-white rounded-3xl p-8 shadow-2xl max-w-sm mx-4 transform animate-slideUp relative">
                    <button onclick="this.closest('.fixed').remove()" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600 transition-colors">‚úï</button>
                    <div class="text-center">
                        <div class="bg-gradient-to-br from-pink-100 to-purple-100 w-20 h-20 rounded-full mx-auto mb-4 flex items-center justify-center">
                            <svg class="w-10 h-10 text-pink-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"></path>
                            </svg>
                        </div>
                        <h3 class="text-2xl font-bold text-gray-800 mb-2">${brandName}</h3>
                        <p class="text-gray-600">–°–∫–æ—Ä–æ –ø–æ—è–≤–∏—Ç—Å—è!</p>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
            setTimeout(() => modal.remove(), 2000);
        }

        // Init
        loadWishes();
        render();
    </script>
</body>
</html>
